(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{609:function(e,t,n){"use strict";n.r(t);var i=n(2),a=n(1),c=n.n(a),s=(n(257),n(14),n(3),n(16),n(18),n(15),n(61),n(21),n(0)),o=n(8),r=n(5),d=(n(6),n(22),function(e){var t=new Date(l(e)),n=new Date,i=Number(n)-Number(t),a=Math.floor(i/1e3/60/60/24);i-=1e3*a*60*60*24;var c=Math.floor(i/1e3/60/60);i-=1e3*c*60*60;var s=Math.floor(i/1e3/60);i-=1e3*s*60;var o=Math.floor(i/1e3);return o<0||s<0||c<0||a<0?{secs:1,min:0,hours:0,days:0}:{secs:o,min:s,hours:c,days:a}}),l=function(e){var t=new Date(1e3*e),n=t.getFullYear(),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()];return t.getDate()+" "+i+" "+n+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()},u=function(e){var t=1===e.time?0:1;return"%s "+({secs:["sec","secs"],min:["min","mins"],hours:["hour","hours"],days:["day","days"]}[e.units]||"min")[t]+" ago"},f=function(){Object(i.a)(c.a.mark((function e(){var t,i,a,l,f,m,g,v,b,p,O,h,L,M,j,k,w,y,_,C,E;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,i=!1,a=JSON.parse(o.a.getItem("notification","storedMessages")||"[]"),l=Number(o.a.getItem("notification","lastUpdate")),e.next=6,Promise.all([n.e(119),n.e(46)]).then(n.bind(null,800));case 6:return e.next=8,e.sent;case 8:return f=e.sent,m=new f.OlNotifications("prod",(function(){})),e.next=12,n.e(92).then(n.t.bind(null,784,7));case 12:g=e.sent,v=g.default,"#notification-center-menu-trigger-units","#notification-center-menu-trigger","#notification-center-menu-trigger .icon","#notification-center-menu-side","#notification-center-menu-side-list",".notification-center-menu-side__card.-preview","#notification-center-menu-side-detail","#notification-center-menu-side-detail-content","#notification-center-menu-side-empty","#notification-center-menu-side__title-icon-close","#notification-center-menu-side-detail-controls-back","#notification-center-menu-side-detail-controls-remove",b=Object(s.c)("#notification-center-menu-side-empty"),p={messageCallbacks:function(e){t||(e.length&&o.a.setItem("notification","storedMessages",JSON.stringify(e)),E()),O(e,"#notification-center-menu-side-list"),C(".notification-center-menu-side__card.-preview")},newMessagesCallback:function(e){O(e,"#notification-center-menu-side-list"),C(".notification-center-menu-side__card.-preview")},updatedMessagesCallback:function(){},deletedMessagesCallback:function(){},metaCallback:function(e){h(e,"#notification-center-menu-trigger-units")}},m.initialize((function(){})),m.setTrackingId(gr.user.id,(function(){})),m.setMessageCallbacks(p.messageCallbacks,p.newMessagesCallback,p.updatedMessagesCallback,p.deletedMessagesCallback,p.metaCallback),O=function(e,n){if(0!==e.length){if(!t){b&&b.classList.add("-hidden");var i=e.map((function(e){var t,n,i=d(e.delivered_at),a=(t=i,n="secs",Object.keys(t).forEach((function(e){t[e]>0&&(n=e)})),{time:t[n],units:n}),c=u(a),s=Object(r.a)(c,a.time);return v({content:e.content,id:e.id,main_image:e.card_url,main_title:e.sline,phash:e.phash,read:e.read,timeString:s})})),a=Object(s.c)(n);a&&(a.innerHTML=i.join("")),t=!0}}else b&&!t&&b.classList.remove("-hidden")},h=function(e,t){var n=Object(s.c)(t);n&&(i||(e.unread?(n.innerHTML=e.unread.toString(),n.classList.add("-visible"),i=!0,j({filledTrigger:!0})):n.classList.remove("-visible")))},L=function(){var e=Object(s.c)("#notification-center-menu-trigger-units"),t=m.getCurrentMetaData(a).unread;e&&(t?e.innerHTML=String(t):e&&e.classList.remove("-visible"))},M=function(){var e=Object(s.c)("#notification-center-menu-side"),t=Object(s.d)(".notification.notify.notify--banner, .top-banner"),n=Object(s.c)("#navigation"),i=0;e&&t&&n&&(i=null==n?void 0:n.offsetHeight,null==t||t.map((function(e){i+=e.offsetHeight})),e.style.top=i+"px")},j=function(e){var t=e.openTrigger,n=e.filledTrigger,i=e.notificationsOpened,a=Object(s.c)("#notification-center-menu-trigger .icon"),c=t?i:!n;null==a||a.classList[c?"add":"remove"]("icon--notification"),null==a||a.classList[c?"remove":"add"]("icon--notification-filled")},k=function(){var e,t=Object(s.c)("#notification-center-menu-side"),n="notifications-open"===document.body.dataset.trigger,i=Object(s.c)("#notification-center-menu-trigger-units");j({openTrigger:!0,notificationsOpened:n}),n?(m.getCurrentMetaData(a).unread?null==i||i.classList.add("-visible"):null==i||i.classList.remove("-visible"),null==t||t.classList.remove("-opened")):(m.getCurrentMetaData(a).unread&&(null==i||i.classList.remove("-visible")),null==t||t.classList.add("-opened")),M(),null===(e=Object(s.c)("#notification-center-menu-trigger"))||void 0===e||e.classList.toggle("-opened"),document.body.dataset.trigger=n?"":"notifications-open",window.dispatchEvent(new Event("resize"))},w=function(e){var t,n=e.target,i=n.closest(".notification-center-menu-side__card.-preview"),c=Object(s.c)("#notification-center-menu-side-detail-content"),r=Object(s.c)("#notification-center-menu-side-list"),d=Object(s.c)("#notification-center-menu-side-detail-controls-back"),l=Object(s.c)("#notification-center-menu-side-detail-controls-remove"),u=Object(s.c)("#notification-center-menu-side-detail");a=JSON.parse(o.a.getItem("notification","storedMessages")||"[]"),n.dataset.content?(t=n.dataset,n.classList.add("-read")):(t=i.dataset,i.classList.add("-read")),c&&(c.innerHTML=t.content),d&&(d.dataset.id=t.id),l&&(l.dataset.id=t.id),null==u||u.classList.remove("-hidden"),null==r||r.classList.add("-hidden"),m.setPhash(t.phash),m.markAsReadMessage(t.id),"0"!==n.dataset.read&&"0"!==i.dataset.read||(o.a.setItem("notification","storedMessages",JSON.stringify(m.markAsReadStoredMessage(a,Number(t.id)))),L())},y=function(){var e=Object(s.c)("#notification-center-menu-side-detail-content"),t=Object(s.c)("#notification-center-menu-side-detail"),n=Object(s.c)("#notification-center-menu-side-list");t&&t.classList.add("-hidden"),e&&(e.innerHTML=""),null==n||n.classList.remove("-hidden")},_=function(){var e=Object(s.c)("#notification-center-menu-side-detail-content"),n=Object(s.c)("#notification-center-menu-side-detail"),i=Object(s.c)("#notification-center-menu-side-list"),c=Object(s.c)("#notification-center-menu-side-detail-controls-remove");a=JSON.parse(o.a.getItem("notification","storedMessages")||"[]");var r=Number(null==c?void 0:c.dataset.id),d=null==c?void 0:c.dataset.phash,l=Object(s.c)('[data-id="'+r+'"]'),u=m.deleteStoredMessage(a,r);n&&n.classList.add("-hidden"),e&&(e.innerHTML=""),l&&l.remove(),d&&m.setPhash(d),m.deleteMessage(r),0===u.length?(t=!1,i&&(i.innerHTML="")):null==i||i.classList.remove("-hidden"),o.a.setItem("notification","storedMessages",JSON.stringify(u))},C=function(e){Object(s.d)(e).map((function(e){e.removeEventListener("click",w),e.addEventListener("click",w)}))},E=function(){var e,t,n,i;null===(e=Object(s.c)("#notification-center-menu-side-detail-controls-back"))||void 0===e||e.addEventListener("click",y),null===(t=Object(s.c)("#notification-center-menu-side-detail-controls-remove"))||void 0===t||t.addEventListener("click",_),null===(n=Object(s.c)("#notification-center-menu-trigger"))||void 0===n||n.addEventListener("click",k),null===(i=Object(s.c)("#notification-center-menu-side__title-icon-close"))||void 0===i||i.addEventListener("click",k)},function(){!l||l&&(d(l).min>=5||d(l).hours>=1||d(l).days>=1)?(m.getNewServerMessages(),o.a.setItem("notification","lastUpdate",String((new Date).getTime()/1e3))):(p.messageCallbacks(a),p.metaCallback(m.getCurrentMetaData(a)))}(),M();case 45:case"end":return e.stop()}}),e)})))()};FEATURE_OTHERLEVELS_ENABLED&&(gr.user?f():gr.addEventListener("gr:update:user",f))}}]);
//# sourceMappingURL=9.9e71a0054ab9579c9ebe8ea938a6e867.js.map